{"payload":{"source":"pragma solidity ^0.4.9;\r\n\r\ncontract SingleDataProviderEscrowContract {\r\n\r\n    // State variables\r\n    address public querier;\r\n    string public queryURI;\r\n    address public target;\r\n    uint public amount;\r\n    string public queryResultHash;\r\n\r\n    enum State { Created, Completed, Inactive }\r\n    State public state = State.Created;\r\n\r\n    function Query(string _queryURI, address _target, uint _amount)\r\n      payable\r\n    {\r\n        querier = msg.sender;\r\n        queryURI = _queryURI;\r\n        target = _target;\r\n        amount = _amount;\r\n    }\r\n\r\n    modifier onlyQuerier() {\r\n        if (msg.sender != querier) throw;\r\n        _;\r\n    }\r\n\r\n    modifier onlyTarget() {\r\n        if (msg.sender != target) throw;\r\n        _;\r\n    }\r\n\r\n    modifier inState(State _state) {\r\n        if (state != _state) throw;\r\n        _;\r\n    }\r\n\r\n    event queryRun(address target);\r\n    event queryPaymentSent(address from, address to, uint amount);\r\n    event inactivated();\r\n\r\n    /// Called by the specified data provider after\r\n    // algorithm execution.\r\n    function confirmQueryRun()\r\n        onlyTarget()\r\n        inState(State.Created)\r\n        returns(bool success)\r\n    {\r\n        queryRun(msg.sender);\r\n        state = State.Completed;\r\n        return true;\r\n    }\r\n\r\n    /// Uses the withdrawal pattern to allow the\r\n    /// target data provider to retrieve their payment.\r\n    // See: http://solidity.readthedocs.io/en/develop/common-patterns.html\r\n    function withdraw()\r\n        onlyTarget\r\n        inState(State.Completed)\r\n        returns(bool success)\r\n    {\r\n        // The pending payment for the data provider must\r\n        // be zeroed before sending to prevent re-entrancy\r\n        // attacks\r\n        uint payment = amount;\r\n        amount = 0;\r\n        if (msg.sender.send(payment)) {\r\n            queryPaymentSent(querier, msg.sender, amount);\r\n            state = State.Inactive;\r\n            return true;\r\n        } else {\r\n            amount = payment;\r\n            return false;\r\n        }\r\n    }\r\n\r\n}","bytecode":"6060604052600580546000919060ff19166001835b0217905550341561002157fe5b5b610723806100316000396000f300606060405236156100965763ffffffff7c01000000000000000000000000000000000000000000000000000000006000350416633ccfd60b81146100985780634db25b5b146100bc578063a122c1001461014c578063a896e64e146101ac578063aa8c217c1461023c578063c19d93fb1461025e578063d4b8399214610292578063d8c5e780146102be578063e88e9241146102ea575bfe5b34156100a057fe5b6100a861030e565b604080519115158252519081900360200190f35b34156100c457fe5b6100cc610406565b604080516020808252835181830152835191928392908301918501908083838215610112575b80518252602083111561011257601f1990920191602091820191016100f2565b505050905090810190601f16801561013e5780820380516001836020036101000a031916815260200191505b509250505060405180910390f35b6101aa600480803590602001908201803590602001908080601f0160208091040260200160405190810160405280939291908181526020018383808284375094965050600160a060020a038535169460200135935061049392505050565b005b34156101b457fe5b6100cc610502565b604080516020808252835181830152835191928392908301918501908083838215610112575b80518252602083111561011257601f1990920191602091820191016100f2565b505050905090810190601f16801561013e5780820380516001836020036101000a031916815260200191505b509250505060405180910390f35b341561024457fe5b61024c610590565b60408051918252519081900360200190f35b341561026657fe5b61026e610596565b6040518082600281111561027e57fe5b60ff16815260200191505060405180910390f35b341561029a57fe5b6102a261059f565b60408051600160a060020a039092168252519081900360200190f35b34156102c657fe5b6102a26105ae565b60408051600160a060020a039092168252519081900360200190f35b34156102f257fe5b6100a86105bd565b604080519115158252519081900360200190f35b600254600090819033600160a060020a0390811691161461032f5760006000fd5b6001805b60055460ff16600281111561034457fe5b1461034f5760006000fd5b60038054600091829055604051909350600160a060020a0333169184156108fc02918591818181858888f19350505050156103f45760005460035460408051600160a060020a03938416815233909316602084015282810191909152517f6487409afdae52da7f03558cf6f2decb9b508eccf41b050ea2b3df993e9ff4989181900360600190a1600580546002919060ff19166001835b0217905550600192506103fe565b6003829055600092505b5b5b505b5090565b60018054604080516020600284861615610100026000190190941693909304601f8101849004840282018401909252818152929183018282801561048b5780601f106104605761010080835404028352916020019161048b565b820191906000526020600020905b81548152906001019060200180831161046e57829003601f168201915b505050505081565b6000805473ffffffffffffffffffffffffffffffffffffffff191633600160a060020a031617905582516104ce906001906020860190610657565b506002805473ffffffffffffffffffffffffffffffffffffffff1916600160a060020a03841617905560038190555b505050565b6004805460408051602060026001851615610100026000190190941693909304601f8101849004840282018401909252818152929183018282801561048b5780601f106104605761010080835404028352916020019161048b565b820191906000526020600020905b81548152906001019060200180831161046e57829003601f168201915b505050505081565b60035481565b60055460ff1681565b600254600160a060020a031681565b600054600160a060020a031681565b60025460009033600160a060020a039081169116146105dc5760006000fd5b6000805b60055460ff1660028111156105f157fe5b146105fc5760006000fd5b60408051600160a060020a033316815290517f6868332249d8c4625bbd17697d60ecfe3db637a2acd8eb9ec0126cbfc552f8dc9181900360200190a1600580546001919060ff191682805b0217905550600191505b5b505b90565b828054600181600116156101000203166002900490600052602060002090601f016020900481019282601f1061069857805160ff19168380011785556106c5565b828001600101855582156106c5579182015b828111156106c55782518255916020019190600101906106aa565b5b506104029291506106d6565b5090565b61065491905b8082111561040257600081556001016106dc565b5090565b905600a165627a7a72305820f0848ffaeb5417fd9dceaec650dbcde35288c9a228f0327134522a4ca0a63daf0029","exp":987654321,"iat":123456789},"signatures":[{"protected":{"typ":"JWS","alg":"KS256"},"signature":"MEUCIQDDV4AAlWBCFFOOmKjM1jN7gy3K3Mwqd-zW5mkFBVDuNQIgFJHBVCIGHjkVBhdTGmJ6vV2vJY_ANq1M6W0H5cvY5LY"}]}
